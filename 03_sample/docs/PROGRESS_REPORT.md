# 完全自律型AIエージェント構築 - 進捗報告

> 報告日: 2026-02-06
> 更新日: 2026-02-07
> 報告者: 開発チーム

---

## 1. 目指す世界

### 最終ゴール: 使うほど賢くなる自律型AIエージェント

**AIが人間と同じようにアプリを操作し、人間が働くたびにAIのスキルが増え続ける仕組みを作る。**

現在のAIは「考える」ことは得意だが、「アプリを操作する」ことができない。Salesforceを開く、Excelにデータを入力する、Slackでメッセージを送る ── これらは全て人間が手でやる必要がある。この「操作の壁」を取り払い、AIが業務を端から端まで自律的に遂行できるようにする。

```
【現状】人間がAIの手足になっている
  AI: 「このデータを分析しました。Slackに投稿してください」
  人間: (手動でSlackを開いて、コピペして、送信ボタンを押す)

【目指す姿】AIが自分で操作する
  AI: 「分析完了。Slackに投稿します」→ 自動でSlackを開き、入力し、送信
```

### コア思想: スキル成長サイクル

このシステムの最大の特徴は、**人間が普段の仕事をするだけでAIの能力が自動的に拡張される**点にある。

```
  社員が日常業務を行う
        │
        ▼
  ┌──────────┐
  │  記 録   │  人間の操作をバックグラウンドで記録
  └────┬─────┘
       │
       ▼
  ┌──────────┐
  │ スキル化  │  記録した操作をパラメータ化し、再利用可能な「スキル」にする
  └────┬─────┘
       │
       ▼
  ┌──────────┐
  │  蓄 積   │  スキルDBに登録 → AIが呼び出し可能になる
  └────┬─────┘
       │
       ▼
  ┌──────────┐
  │  活 用   │  AIが業務の中でスキルを自動選択・実行
  └────┬─────┘
       │
       ▼
  ┌──────────┐
  │  改 善   │  失敗時は再記録、アプリ更新時はスキル更新
  └────┬─────┘
       │
       └──→ 繰り返し（スキルが増え、AIが対応できる業務範囲が拡大し続ける）
```

**つまり:** 社員10人が1ヶ月働けば、数百の操作スキルが自然に蓄積される。新しいアプリを使い始めれば、そのアプリの操作スキルも自動的に追加される。AIは使えば使うほど、対応できる業務の幅が広がり続ける。

### 具体的なユースケース

**例: 「今週の売上データをまとめてチームに共有して」と指示するだけで:**

```
[1] Salesforce操作スキル → ブラウザでSalesforceを開き、CSV出力
[2] 分析スキル（AI思考） → データを分析、要約テキスト生成
[3] Docs操作スキル       → Google Docsでレポート作成
[4] Slack操作スキル      → チャンネルに投稿、リンク添付
```

各「操作スキル」は人間が一度やって見せた操作の記録から生成されたもの。

---

## 2. このゴールに対して検証すべきこと

上記を実現するための基盤技術が「Screen Action Recorder」である。まず**macOS上で操作の記録・再生が技術的に成立するか**を検証する必要がある。

### 検証の全体像

```
Phase 1: 記録できるか        Phase 2: 再生できるか        Phase 3: 実用になるか
┌─────────────────────┐    ┌─────────────────────┐    ┌─────────────────────┐
│ V1 クリック記録      │    │ V2 クリック再生      │    │ V6 統合シナリオ      │
│ V3 キーボード取得    │    │ V4 キーボード再生    │    │ V7 スキル化          │
│ V5 日本語入力        │    │                      │    │ V8 AI補完            │
└─────────────────────┘    └─────────────────────┘    └─────────────────────┘
     ✅ 完了                    ✅ 完了                   🔜 次のフェーズ
```

| # | 検証項目 | 問い | 判断基準 |
|---|---------|------|---------|
| V1 | クリック記録 | Accessibility APIでUI要素情報を取得できるか | 主要アプリで要素取得率80%以上 |
| V2 | クリック再生 | 記録した要素を再検索して正しくクリックできるか | identifier/title等で再特定可能 |
| V3 | キーボード取得 | CGEventTapで全キー種別を捕捉できるか | 英数字・修飾キー・特殊キーの取得 |
| V4 | キーボード再生 | CGEventCreateKeyboardEventで正しく入力できるか | 大小文字・数字・ショートカットの正確な再現 |
| V5 | 日本語入力 | IME経由の入力を記録・再生できるか | keycodeベースでの再現可否 |
| V6 | 統合動作 | クリック+キーボードを組み合わせた実操作シナリオが動くか | LINE入力、Safari URL入力等 |
| V7 | スキル化 | 記録をパラメータ化して汎用的に再利用できるか | 異なる入力値での再実行 |
| V8 | AI補完 | 要素が見つからない場合にAI画像認識で代替できるか | Electron系アプリでの再生成功 |

---

## 3. 現在の到達点

### ステータス一覧

```
V1 クリック記録    ████████████ 完了
V2 クリック再生    ████████████ 完了
V3 キーボード取得  ████████████ 完了
V4 キーボード再生  ████████████ 完了
V5 日本語入力      ████████████ 完了（制約あり）
V6 統合動作        ███░░░░░░░░░░ 着手済み（統合実装完了、テスト未了）
V7 スキル化        ░░░░░░░░░░░░ 未着手
V8 AI補完          ░░░░░░░░░░░░ 未着手
```

**要約: 「記録できるか」「再生できるか」の基礎検証は全て完了。レコーダー/プレイヤー統合を実装済みで、次は実操作シナリオの統合テストに進む段階。**

### V1-V2: クリック記録・再生

4セッション・48アクションで検証済み。

| 指標 | 結果 |
|------|------|
| 要素取得成功率 | **91.7%**（権限正常時は100%） |
| テスト済みアプリ | Finder, LINE, システム設定, テキストエディット, Cursor, ターミナル |

アプリ種別ごとに再生の信頼度が異なる:

| アプリ種別 | 代表例 | 再生信頼度 | 理由 |
|-----------|--------|-----------|------|
| macOSネイティブ | テキストエディット, システム設定 | **高** | 要素ID・タイトルが豊富 |
| macOSシステム | Finder, 通知センター | **中〜高** | 右クリックメニュー等も対応 |
| チャットアプリ | LINE | **中** | IDなし、表示テキストで補助 |
| Electron系 | Cursor | **低** | 識別情報がほぼ空 → V8(AI補完)が必要 |

### V3-V5: キーボード入力

4段階の段階的検証を実施し、全て合格。

| Step | 検証内容 | 結果 |
|------|---------|------|
| Step 1 | 基本キー取得（英数字・Enter・Tab・矢印） | **合格** |
| Step 2 | 修飾キー取得（Cmd/Shift/Option/Control） | **合格** |
| Step 3 | 日本語入力（IME）の挙動 | **合格**（制約あり） |
| Step 4 | キーボード再生 | **合格**（バグ修正済み、再テストはV6統合テストで再確認） |

**統合状況:** 2026-02-07 にレコーダー/プレイヤーへの統合を実装完了（V6テスト待ち）。

**Step 4の再生テスト結果（参考）:**

テキストエディットに対して6種類の自動入力を実行し、全て期待通りに動作。

| テスト | 内容 | 結果 |
|--------|------|------|
| A | "Hello World"（大小文字混在） | 正しく入力 |
| B | Enterキー（改行） | 正しく改行 |
| C | "12345.67"（数字+記号） | 正しく入力 |
| D | Cmd+A（全選択ショートカット） | 正しく全選択 |
| E | 矢印キー | 正しく動作 |
| F | Tab + 文字（インデント） | 正しくインデント |

**発見・修正したバグ:** Shiftキーのフラグが後続のキーに固着し、全文字が大文字/記号になる問題。原因はCGEventSetFlagsの呼び出し漏れ。毎回明示的にフラグを設定することで解消。

**日本語入力の制約:** IME処理前の生キーコード（ローマ字）での記録となる。変換後のひらがなは直接取得できないが、keycodeをそのまま再生すれば同じ日本語が入力されるため、実用上は問題ない。

---

## 4. 現時点の課題

| # | 課題 | 影響 | 対応方針 |
|---|------|------|---------|
| 1 | Electron系アプリの識別情報不足 | Cursorなどで要素の再特定が困難 | V8（AI画像認識）で補完 |
| 2 | Terminal.appのframe取得失敗 | 座標計算ができない | パーサーのバグ修正 |
| 3 | 統合テスト未実施 | 実操作シナリオでの挙動が未確認 | V6でテスト実施 |
| 4 | 日本語変換の辞書差異 | 環境によって変換結果が異なる可能性 | 許容範囲として扱い、将来AI補完で対応 |

---

## 5. 次のアクション

### 直近: V6 統合テスト（1〜2日）

キーボード記録・再生の統合は完了。**クリック+入力を組み合わせた実操作シナリオ**で動作を検証する。

| テストID | シナリオ | 検証ポイント |
|----------|---------|-------------|
| B2 | LINEでメッセージ入力+送信 | テキスト入力とクリックの連携 |
| C1 | SafariでURL入力+遷移 | テキスト入力+Enterキー |
| D1 | Numbersでセルにデータ入力 | Tab/Enterによるセル移動+入力 |
| E4 | ショートカットキー操作 | Cmd+C/V等の修飾キー付き操作 |

### 中期ロードマップ

```
【基盤検証】                  【実用化】                   【自律化】
 V1-V5 基礎技術 ✅            V6 統合テスト 実施中         V7 スキル化
    │                           │                            │
    │                           ▼                            ▼
    │                       AI判断レイヤー              オーケストレーター
    │                       (要素が見つからない時の       (AIがスキルを選択・
    │                        画像認識フォールバック)       組み合わせてタスク実行)
    │                           │                            │
    │                           ▼                            ▼
    │                       ブラウザ対応                 スキル成長サイクル
    │                       (Safari/Chrome内の           (人間の操作が自動的に
    └── 今ここ               DOM要素も取得)              スキルとして蓄積・改善)
```

**V6の統合テストが通れば、「記録・再生」の技術基盤は確立。** その後はスキル化・AI補完・オーケストレーションを積み上げ、最終的に「指示するだけで業務が完結し、使うほど賢くなるAIエージェント」の実現に向かう。

---

## 6. まとめ

- **目指すもの:** 人間が働くほどスキルが蓄積し、AIの自律範囲が拡大し続ける仕組み
- **現在地:** 基盤技術（クリック+キーボードの記録・再生）の検証が**全て完了**
- **次の一手:** 実操作シナリオでの統合テスト（1〜2日）→ ここが通れば技術基盤確立
